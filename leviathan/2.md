# Leviathan: Level 2 Writeup

    ssh leviathan2@leviathan.labs.overthewire.org -p 2223
    password: ougahZi8Ta

![](img/2/0.png)

Elimizde gene 32 bit Ã§alÄ±ÅŸtÄ±rÄ±labilir bir linux dosyasÄ± mevcut. HÄ±zlÄ±ca bakalÄ±m ne iÅŸe yarÄ±yormuÅŸ

![](img/2/1.png)

Bizden argÃ¼man olarak bir dosya istiyor ve daha sonra o dosyanÄ±n iÃ§erisinde yazan ÅŸeyi ekrana basÄ±yor. Eee durum bÃ¶yle olunca tabi aklÄ±mÄ±za ilk olarak `leviathan3` kullanÄ±cÄ±sÄ±nÄ±n parolasÄ±nÄ±n olduÄŸu dosyayÄ± okutmak geliyor.

![](img/2/2.png)

Ancak o kadar da basit deÄŸil :joy: GerÃ§i buraya kadar gelmiÅŸiz biraz zor olsun tabi

`ltrace` ile bi gÃ¶z gezdirelim arkada ne olaylar dÃ¶nÃ¼yormuÅŸ

![](img/2/3.png)

Ä°lk Ã¶nce okumak istediÄŸimiz dosyanÄ±n ne olduÄŸuna bakÄ±yor. Daha sonra bu dosyada yetkimiz var mÄ± yok mu bunu kontrol ediyor. EÄŸer yetkimiz yok ise iÃ§eriÄŸini bize gÃ¶stermiyor ğŸ¤”

`NOT` : Burda yetkimizin olup olmadÄ±ÄŸÄ±nÄ± ilk baÅŸta bulunan `access` fonksiyonu ile tespit ediyor. Dosya leviathan3'e ait iken biz leviathan2 kullanÄ±cÄ±sÄ± olarak bakmaya Ã§alÄ±ÅŸtÄ±ÄŸÄ±mÄ±zda da haliyle bize gÃ¶stermiyor

Pekala o zaman biz bunu nasÄ±l okuyacaz ? Yok mudur bunun bir yolu yordamÄ± ? Eh soru olarak bÃ¶yle biÅŸi koydularsa vardÄ±r biÅŸiler heralde ğŸ˜

Bunu isterseniz uygulamalÄ± olarak gÃ¶sterelim

```C
#include <stdio.h>
#include <stdlib.h>

int main(void) {
  system("/bin/cat 1 2 '1 2'");
}
```

![](img/2/test-code.png)

Åimdi `/bin/cat` iÅŸlemine 3 tane argÃ¼man verdik ve 3 argÃ¼manÄ±da ekrana bastÄ±. Burda dikkatimizi Ã§eken birÅŸey var. '1 2' olarak yazdÄ±ÄŸÄ±mÄ±z zaman bizim `'1 2'` isimli dosyamÄ±zÄ±n iÃ§eriÄŸini ekrana basÄ±yor Ã¶yle deÄŸil mi ? Ancak tÄ±rnak ifadeleri olmadan direk `1 2` yazarsam Ã¶nce `1` isimli dosyanÄ±n sonra `2` numaralÄ± dosyayÄ±n iÃ§eriÄŸini ekrana basÄ±yor.

Yukarda bakmÄ±ÅŸ olduÄŸumuz `ltrace` Ã§Ä±ktÄ±sÄ±na bakacak olursak eÄŸer girmiÅŸ olduÄŸumuz dizini `' ' (tek tÄ±rnaklar)` arasÄ±na almadan direk argÃ¼man olarak kullanÄ±yor. Yani ben `/etc/leviathan_pass/leviathan3` dosyasÄ±nÄ± `ln` komutu yardÄ±mÄ±yla bir dosya Ã¼zerine linklendirme/baÄŸlantÄ± kurma iÅŸlemi gerÃ§ekleÅŸtirsem ve daha sonra sembolik baÄŸlantÄ± dosyasÄ±nÄ±n adÄ±nda bir dosya daha oluÅŸturup arasÄ±nda boÅŸluk bÄ±rakarak yanÄ±na rastgele bir kelime daha eklesem nasÄ±l olur ?

Ã–rnek verecek olacak olursak eÄŸer;

    ln -s /etc/leviathan_pass/leviathan3 leviathan3password
    touch leviathan3password\ falanfilan

ArtÄ±k iki tane dosyam var. Biri direk `leviathan3password->/etc/leviathan_pass/leviathan3` diÄŸeri ise `'leviathan3password falanfilan'`

Ben eÄŸer argÃ¼man olarak `leviathan3password falanfilan` dosyasÄ±nÄ± verirsem bu dosyanÄ±n izinlere bana ait olduÄŸu iÃ§in `access` kontrolÃ¼nden geÃ§ecektir. Daha sonra `system` fonksiyonu iÃ§erisinde gelecektir. DosyanÄ±n yolunu tÄ±rnak iÃ§erisinde almadÄ±ÄŸÄ± iÃ§inde `leviathan3password` ve `falanfilan` isimli iki ayrÄ± dosyayÄ± okuyup ekrana basmaya Ã§alÄ±ÅŸacaktÄ±r.

SanÄ±rÄ±m bu kÄ±smÄ± anlatabildim. EÄŸer kafalarda soru iÅŸareti kalmadÄ±ysa devam edelim ve bunu uygulayalÄ±m

![](img/2/4.png)

Ve gÃ¶rdÃ¼ÄŸÃ¼nÃ¼z gibi yaptÄ±ÄŸÄ±mÄ±z iÅŸlem iÅŸe yaradÄ± ve `leviathan3` kullanÄ±cÄ±sÄ±nÄ±n parolasÄ±nÄ± elde ettik.

`leviathan3:Ahdiemoo1j`

`NOT`: Bu ÅŸekilde argÃ¼man verdiÄŸimiz zaman arkada dÃ¶nen olayÄ± gÃ¶rmek isteyenler iÃ§in ÅŸunuda ÅŸuraya bÄ±rakayÄ±m

![](img/2/5.png)
